# ğŸ§  Smart Finance AI

### MCP-Powered Financial Orchestration System

> A production-style AI financial assistant built using Multi-Server MCP architecture, FastAPI orchestration, and a real-time streaming React interface.

---

## ğŸš€ Overview

Smart Finance AI is a modular financial intelligence platform that combines:

* ğŸ§® Financial mathematics
* ğŸ“ˆ Investment simulations
* ğŸ’° Expense & budgeting analysis
* ğŸ“Š Graph generation
* ğŸ§  AI orchestration with tool routing
* âš¡ Real-time streaming responses
* ğŸ–¥ Modern ChatGPT-style frontend

Instead of building a single monolithic AI, this project implements a **microservice-based MCP ecosystem** coordinated by a central AI Orchestrator.

---

# ğŸ— Architecture

```
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚        React UI          â”‚
                â”‚  (Streaming Chat + Graphs)â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ SSE
                              â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚    FastAPI Orchestrator  â”‚
                â”‚  (LangChain + MCP Client)â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼               â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ math_serverâ”‚  â”‚investment  â”‚  â”‚expense     â”‚  â”‚chart_serverâ”‚
â”‚            â”‚  â”‚_server     â”‚  â”‚_server     â”‚  â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ§© Core Components

## 1ï¸âƒ£ MCP Servers (Microservices)

Each financial capability is isolated into its own MCP server.

### ğŸ”¢ Math Server

Handles:

* SIP future value
* EMI calculations
* CAGR
* Inflation adjustments
* Retirement corpus
* Monte Carlo simulation

---

### ğŸ“Š Investment Server

Handles:

* Portfolio projections
* Long-term simulations
* Lump-sum forecasting
* Risk modeling

---

### ğŸ’µ Expense Server

Handles:

* Savings rate calculation
* Emergency fund estimation
* Investment capacity analysis
* Retirement affordability

---

### ğŸ“ˆ Chart Server

Handles:

* Financial growth visualization
* Investment trajectory graphs
* Base64 image generation
* Plot rendering via matplotlib

---

## 2ï¸âƒ£ AI Orchestrator (FastAPI + LangChain)

The orchestrator:

* Maintains session memory
* Injects financial system persona
* Streams tokens via SSE
* Detects tool calls
* Executes remote MCP tools
* Injects tool results back into LLM
* Streams final answer
* Caches tool connections

It acts as the **central brain of the system**.

---

# ğŸ’¬ Streaming Protocol

The backend uses Server-Sent Events (SSE).

Event format:

```json
{
  "type": "token" | "status" | "tool_start" | "tool_end" | "error" | "done",
  "content": "...",
  "tool": "..."
}
```

This allows:

* Real-time typing effect
* Tool execution indicators
* Graph rendering
* Error visibility

---

# ğŸ“‚ Repository Structure

```
Smart-Finance-AI/
â”‚
â”œâ”€â”€ mcp_servers/
â”‚   â”œâ”€â”€ math_server/
â”‚   â”œâ”€â”€ investment_server/
â”‚   â”œâ”€â”€ expense_server/
â”‚   â””â”€â”€ chart_server/
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ system_prompts.py
â”‚   â”œâ”€â”€ session_memory.py
â”‚   â”œâ”€â”€ mcp_client.py
â”‚   â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ frontend/  (React UI)
â”‚
â””â”€â”€ README.md
```

---

# ğŸ§  System Prompt Specialization

The AI is constrained to:

* Finance
* Investments
* Economics
* Financial math

It will politely decline unrelated queries.

This ensures domain consistency and tool alignment.

---

# ğŸ—ƒ Session Memory

* In-memory session tracking
* Automatic system prompt injection
* Token trimming protection
* Multi-session support via session_id

---

# ğŸ“Š Graph Rendering

Charts are generated by the MCP chart server.

Tool result example:

```json
{
  "image_base64": "iVBORw0KGgoAAAANS..."
}
```

Frontend renders:

```
data:image/png;base64,...
```

This enables inline financial visualizations inside chat.

---

# âš¡ Key Engineering Decisions

### âœ” Microservice Architecture

Each financial domain is isolated.

### âœ” Tool-Oriented LLM Reasoning

LLM decides when precision is required.

### âœ” SSE Streaming

Real-time UX, no polling.

### âœ” Stateless Orchestrator

Session-based memory without database (MVP ready).

### âœ” Production-Ready Patterns

* Error handling
* Tool caching
* Token trimming
* JSON-safe tool output
* Structured events

---

# ğŸ›  Tech Stack

## Backend

* FastAPI
* LangChain
* OpenAI GPT-5
* MCP (Multi-Server Protocol)
* Python 3.12
* AsyncIO

## Frontend

* React
* Streaming via ReadableStream
* Markdown rendering
* Dynamic graph rendering

## Visualization

* Matplotlib
* Base64 encoding

---

# ğŸ§ª Example Query Flow

User:

> I earn â‚¹100,000 per month and spend â‚¹60,000. Invest the rest at 12% for 10 years.

System:

1. AI calculates savings using expense_server
2. AI computes future value using math_server
3. AI generates projection chart using chart_server
4. Results streamed in real-time
5. Graph rendered inline

---

# ğŸš€ Running Locally

### 1ï¸âƒ£ Start MCP Servers

Each server:

```bash
uv run fastmcp dev main.py
```

---

### 2ï¸âƒ£ Start Backend

```bash
uvicorn backend.main:app --reload
```

---

### 3ï¸âƒ£ Test Streaming

```bash
python test_stream.py
```

---

### 4ï¸âƒ£ Start React Frontend

```bash
npm install
npm run dev
```

---

# ğŸ” Security Considerations

* API keys stored in `.env`
* No API key exposure to frontend
* Backend-only OpenAI calls
* HTTPS recommended in production

---

# ğŸ“ˆ Future Improvements

* Persistent database memory
* User authentication
* Portfolio tracking dashboard
* Real-time market API integration
* Redis caching
* WebSocket upgrade
* Deployment via Docker

---

# ğŸ§‘â€ğŸ’» Author

[Soumil Malik](https://github.com/SoumilMalik24)
B.Tech Student | AI & Systems Enthusiast
